



6lo                                                      P. Thubert, Ed.
Internet-Draft                                               6 June 2025
Updates: 6550, 8505, 8928, 9010 (if approved)                           
Intended status: Standards Track                                        
Expires: 8 December 2025


              IPv6 Neighbor Discovery Prefix Registration
                 draft-ietf-6lo-prefix-registration-13

Abstract

   This document updates Subnet Neighbor Discovery (RFC 8505, RFC 8928)
   to enable a node that owns or is directly connected to a prefix to
   register that prefix to neighbor routers.  The registration indicates
   that the registered prefix can be reached via the advertising node
   without a loop.  The unicast prefix registration allows the node to
   request neighbor router(s) to redistribute the prefix in another
   routing domain regardless of the routing protocol used in that
   domain.  This document extends Routing Protocol for Low-Power and
   Lossy Networks (RPL) (RFC 6550, RFC 9010) to enable a 6LoWPAN Router
   (6LR) to inject the registered prefix in RPL.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 8 December 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.



Thubert                  Expires 8 December 2025                [Page 1]

Internet-Draft             Prefix Registration                 June 2025


   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   5
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   5
     2.2.  Inherited Terms and Concepts  . . . . . . . . . . . . . .   5
     2.3.  Acronyms and Initialisms  . . . . . . . . . . . . . . . .   6
     2.4.  New terms . . . . . . . . . . . . . . . . . . . . . . . .   7
   3.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   7
   4.  Extending RFC 7400  . . . . . . . . . . . . . . . . . . . . .   8
   5.  Updating RFC 6550 . . . . . . . . . . . . . . . . . . . . . .   9
   6.  Updating RFC 8505 . . . . . . . . . . . . . . . . . . . . . .  10
     6.1.  Leveraging the Target Address to Advertise a Prefix . . .  10
     6.2.  New P-Field value . . . . . . . . . . . . . . . . . . . .  11
     6.3.  New EARO Prefix Length Field and F flag . . . . . . . . .  11
     6.4.  New EDAR Prefix Length Field  . . . . . . . . . . . . . .  13
     6.5.  Amending the Registration Operation . . . . . . . . . . .  14
   7.  Updating RFC 9010 . . . . . . . . . . . . . . . . . . . . . .  16
   8.  Updating RFC 8928 . . . . . . . . . . . . . . . . . . . . . .  17
   9.  Extending RFC 8929  . . . . . . . . . . . . . . . . . . . . .  18
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  18
   11. Operational Considerations  . . . . . . . . . . . . . . . . .  18
     11.1.  Partially Upgraded Networks  . . . . . . . . . . . . . .  19
     11.2.  Application to RPL-Based Route-Over LLNs . . . . . . . .  19
     11.3.  Application to a Shared Link . . . . . . . . . . . . . .  21
     11.4.  Application to a Hub Link with Stub Spokes . . . . . . .  22
   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  23
     12.1.  Updated P-Field Registry . . . . . . . . . . . . . . . .  23
     12.2.  New 6LoWPAN Capability Bit . . . . . . . . . . . . . . .  23
   13. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  24
   14. Normative References  . . . . . . . . . . . . . . . . . . . .  24
   15. Informative References  . . . . . . . . . . . . . . . . . . .  26
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  27

1.  Introduction

   The design of Low Power and Lossy Networks (LLNs) is generally
   focused on saving energy, which is the most constrained resource of
   all.  Other design constraints, such as a limited memory capacity,
   duty cycling of the LLN devices and low-power lossy transmissions,
   derive from that primary concern.  The radio (both transmitting or
   simply listening) is a major energy drain and the LLN protocols must



Thubert                  Expires 8 December 2025                [Page 2]

Internet-Draft             Prefix Registration                 June 2025


   be adapted to allow the nodes to remain sleeping with the radio
   turned off at most times.

   Examples of LLNs include hub-and-spoke access links such as (Low-
   Power) Wi-Fi [IEEE80211] and Bluetooth (Low Energy) [IEEE802151],
   Mesh-Under networks where the routing operation is handled at Layer-
   2, and Route-Over networks such as the Wi-SUN [WI-SUN] and 6TiSCH
   [RFC9030] mesh networks, which leverage 6LoWPAN [RFC4919][RFC6282]
   and RPL [RFC6550] over [IEEE802154].

   LLNs and constrained devices are the original domain of application
   for 6LoWPAN protocols.  It is thus a foremost concern, when designing
   those protocols, to minimize energy spendings.  In non-LLN
   environments where lowering carbon emissions is also a priority, it
   could make sense to apply the 6LoWPAN designs and extend some of the
   6LoWPAN protocols.  The general design points include:

   *  Placing the protocol complexity in the less-constrained routers to
      simplify the host implementation and avoid expanding the control
      traffic to all nodes.

   *  Using host-triggered operations to enable transient disconnections
      with the routers, e.g., to conserve power (sleep), but also to
      cope with inconsistent connectivity.

   This translates into:

   *  Stateful proactively-built knowledge in the routers that is
      available at any point of time.

   *  Unicast host to router operations triggered by the host and its
      applications.

   *  Minimal use of asynchronous L2-broadcast operations that would
      keep the host awake and listening with no application-level need
      to do so.

   The "Routing Protocol for Low Power and Lossy Networks" [RFC6550]
   (RPL) provides IPv6 [RFC8200] routing services within such
   constraints.  To save signaling and routing state in constrained
   networks, the RPL routing is only performed along a Destination-
   Oriented Directed Acyclic Graph (DODAG) that is optimized to reach a
   Root node, as opposed to along the shortest path between 2 peers,
   whatever that would mean in each LLN.

   The classical Neighbor Discovery (IPv6 ND) Protocol (NDP) [RFC4861]
   [RFC4862] was defined for serial links and shared transit media such
   as Ethernet at a time when L2-broadcast was cheap on those media



Thubert                  Expires 8 December 2025                [Page 3]

Internet-Draft             Prefix Registration                 June 2025


   while memory for neighbor cache was expensive.  It was thus designed
   as a reactive protocol that relies on caching and multicast
   operations for the Address Resolution (AR, aka Address Discovery or
   Address Lookup) and Duplicate Address Detection (DAD) of IPv6 unicast
   addresses.  Those multicast operations typically impact every node
   on-link when at most one is really targeted, which is a waste of
   energy, and imply that all nodes are awake to hear the request, which
   is inconsistent with power saving (sleeping) modes.

   The "Architecture and Framework for IPv6 over Non-Broadcast Access"
   (NBMA) [I-D.ietf-6man-ipv6-over-wireless] introduces an evolution of
   IPv6 ND towards a proactive AR method.  Because the IPv6 model for
   NBMA depends on a routing protocol to reach inside the Subnet, the
   IPv6 ND extension for NBMA is referred to as Subnet Neighbor
   Discovery (SND).  SND is based on work done in the context of IoT,
   known as 6LoWPAN ND.  As opposed to the classical IPv6 ND Protocol,
   this evolution follows the energy conservation principles discussed
   above:

   *  The original 6LoWPAN ND, "Neighbor Discovery Optimizations for
      6LoWPAN networks" [RFC6775], was introduced to avoid the excessive
      use of multicast messages and enable IPv6 ND for operations over
      energy-constrained nodes.  [RFC6775] changes the classical IPv6 ND
      model to proactively establish the Neighbor Cache Entry (NCE)
      associated to the unicast address of a 6LoWPAN Node (6LN) in the
      6LoWPAN Router(s) (6LRs) that serve it.  To that effect, [RFC6775]
      defines a new Address Registration Option (ARO) that is placed in
      unicast Neighbor Solicitation (NS) and Neighbor Advertisement (NA)
      messages between the 6LN and the 6LRs.

   *  "Registration Extensions for 6LoWPAN Neighbor Discovery" [RFC8505]
      updates [RFC6775] into a generic Address Registration mechanism
      and is the foundation for Subnet Neighbor Discovery (SND).  SND
      introduces the Extended Address Registration Option (EARO) to
      enable the registering node to access services such as routing
      inside a subnet and ND proxy [RFC8929] operations.  This provides
      a routing-protocol-agnostic method for a host to request that the
      router injects a unicast IPv6 address in the local routing
      protocol and provide return reachability for that address.












Thubert                  Expires 8 December 2025                [Page 4]

Internet-Draft             Prefix Registration                 June 2025


   *  "IPv6 Neighbor Discovery Multicast Address Listener Subscription"
      [RFC9685] updates [RFC8505] to enable a listener to subscribe to
      an IPv6 anycast or multicast address; the draft also extends
      [RFC9010] to enable a 6LR to inject the anycast and multicast
      addresses in RPL.  Similarly, this specification extends [RFC8505]
      and [RFC9010] to add the capability for a 6LN to register unicast
      prefixes up to 120 bits long, as opposed to addresses, and to
      signal in a routing-protocol-independent fashion to a 6LR that it
      is expected to redistribute the prefixes.

   This specification extends the above registration and subscription
   methods to enable a node to register a unicast prefix to the routing
   system and get it injected in the routing protocol.  As with
   [RFC8505], the prefix registration is agnostic to the routing
   protocol in which the router injects the prefix, and the router is
   agnostic to the method that was used to allocate the prefix to the
   node.  The energy conservation principles in [RFC8505] are retained
   as well, meaning that the node does not have to send or expect
   asynchronous multicast messages.

   It can be noted that an energy-conserving node is not necessarily a
   router, so even when advertising a prefix, it is a design choice not
   to use Router Advertisement (RA) messages that would make the node
   appear as a router to peer nodes.  From the design principles above,
   it is clearly a design choice not to leverage broadcasts from or to
   the node, or complex state machines in the node.  It is also a design
   choice to use and extend the EARO as opposed to the Route Information
   Option (RIO) [RFC4191] because the RIO is not intended to inject
   routes in routing, and is lacking related control information like
   the R bit in the EARO.  Additionally, an RA with RIO cannot be
   trusted for a safe injection in the routing protocol for the lack of
   the equivalent of the Registration Ownership Verifier (ROVR)
   [RFC8928] in the EARO.

2.  Terminology

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.2.  Inherited Terms and Concepts

   This document uses terms and concepts that are discussed in:




Thubert                  Expires 8 December 2025                [Page 5]

Internet-Draft             Prefix Registration                 June 2025


   *  "Neighbor Discovery for IP version 6" [RFC4861] and

   *  "IPv6 Stateless Address Autoconfiguration" [RFC4862] for the
      Neighbor Solicitation operation,

   *  Neighbor Discovery Optimization for IPv6 over Low-Power Wireless
      Personal Area Networks (6LoWPANs) [RFC6775], as well as

   *  "Registration Extensions for 6LoWPAN Neighbor Discovery" for SND
      operations [RFC8505] and

   *  "Routing Protocol for Low Power and Lossy Networks" [RFC6550] for
      RPL, which is the routing protocol used in LLNs for SND.

2.3.  Acronyms and Initialisms

   This document uses the following abbreviations:

   *6CIO:*  (6LoWPAN) Capability Indication Option [RFC7400]
   *6LBR:*  (6LoWPAN) Border Router [RFC6775]
   *6LN:*  (6LoWPAN) Node [RFC6775]
   *6LR:*  (6LoWPAN) Router [RFC6775]
   *ARO:*  Address Registration Option [RFC6775]
   *DAD:*  Duplicate Address Detection [RFC4861]
   *DAO:*  Destination Advertisement Object [RFC6550]
   *DODAG:*  Destination-Oriented Directed Acyclic Graph
   *EARO:*  Extended Address Registration Option [RFC8505]
   *EDAC:*  Extended Duplicate Address Confirmation [RFC8505]
   *EDAR:*  Extended Duplicate Address Request [RFC8505]
   *ESS:*  Extended Service Set [IEEE80211]
   *IPAM:*  IP Address Management
   *LLN:*  Low-Power and Lossy Network
   *LLA:*  Link Layer Address
   *LoWPAN:*  Low-Rate Personal Area Network [IEEE802154]
   *MAC:*  Medium Access Control
   *NA:*  Neighbor Advertisement (message) [RFC4861]
   *NBMA:*  Non-Broadcast Multi-Access (full mesh)
   *NCE:*  Neighbor Cache Entry [RFC4861]
   *ND:*  Neighbor Discovery (protocol)
   *NDP:*  Neighbor Discovery Protocol
   *NS:*  Neighbor Solicitation (message) [RFC4861]
   *ROVR:*  Registration Ownership Verifier (pronounced "rover")
      [RFC8505]
   *RPL:*  IPv6 Routing Protocol for LLNs (pronounced "ripple")
      [RFC6550]
   *RA:*  Router Advertisement (message) [RFC4861]
   *RS:*  Router Solicitation (message) [RFC4861]
   *RTO:*  RPL Target Option [RFC6550]



Thubert                  Expires 8 December 2025                [Page 6]

Internet-Draft             Prefix Registration                 June 2025


   *SLLAO:*  Source Link-Layer Address Option [RFC4861]
   *SND:*  Subnet Neighbor Discovery (protocol)
   *TID:*  Transaction ID [RFC8505]
   *TIO:*  Transit Information Option [RFC6550]
   *TLLAO:*  Target Link-Layer Address Option [RFC4861]

2.4.  New terms

   This document introduces the following terms:

   *Origin:*  The node that issued the prefix advertisement, either in
          the form of a NS(EARO) or as a DAO(TIO, RTO)
   *Merge:*  The action of receiving multiple anycast or multicast
          advertisements, either internally from self, in the form of a
          NS(EARO), or as a DAO(TIO, RTO), and generating a single
          DAO(TIO, RTO).  The 6RPL router maintains a state per origin
          for each advertised address, and merges the advertisements for
          all subscriptions for the same address in a single
          advertisement.  A RPL router that merges then becomes the
          origin of the merged advertisement and uses its own values for
          the Path Sequence and ROVR fields.

3.  Overview

   This specification inherits from [RFC6550], [RFC8505], and [RFC9010]
   to register prefixes as opposed to addresses.

   An SND deployment consists of:

   *  One or more 6LBR(s) that act(s) as RPL Root

   *  intermediate routers down the RPL graph that propagate routing
      information on addresses and prefixes towards the Root

   *  6LRs that are RPL-aware 6LNs and can leverage RPL directly to
      expose their addresses and prefixes

   *  and 6LNs that are the RPL-unaware destinations and need SND to
      obtain reachability tover the RPL LLN for their addresses and,
      with this specification, their prefixes as well.

   The SND operation for prefixes inherits from that for unicast
   addresses, meaning that it is the same unless specified otherwise
   herein.  In particular, forwarding a packet happens as specified in
   section 11 of [RFC6550], including loop avoidance and detection,
   though in the case of multicast multiple copies might be generated.





Thubert                  Expires 8 December 2025                [Page 7]

Internet-Draft             Prefix Registration                 June 2025


   [RFC8505] is a pre-requisite to this specification.  A node that
   implements this MUST also implement [RFC8505].  This specification
   does not introduce a new option; it modifies existing options and
   updates the associated behaviors to enable the Registration for
   prefixes as an extension to [RFC8505].

   This specification updates the P-Field introduced in [RFC9685] for
   use in EARO, DAR, and RTO, with the new value of 3 to indicate the
   registration of a prefix, as detailed in Section 6.3.  With this
   extension, the 6LN can now express its willingness to receive the
   traffic for all addresses in the range of a prefix, using the P-Field
   value of 3 in the EARO to signal that the registration is for such
   prefix.  Multiple 6LNs acting as border routers to the same external
   network or as access routers to the same subnet may register the same
   prefix to the same 6LR or to different 6LRs.

   If the R flag is set in the registration of one or more 6LNs for the
   same prefix, then, according to its redistribution policy, the 6LR
   MUST redistribute the prefix in the routing protocol(s) (e.g., RPL)
   that it participates to.  The duration of the redistribution is based
   on the longest registration lifetime across the non-expired received
   registrations for the prefix.

   Examples of use-cases where this specification may apply include
   virtual links, shared links, and hub links as shown in Section 11.3
   and Section 11.4, respectively.  More generally, the 6LN may be a
   router running a different routing protocol in an external network,
   e.g., a stub network, and acting as a border router.  Using the
   prefix registration method enables to decouple the routing protocol
   in the 6LN from the routing protocol that the 6LRs run in the main
   LLN and provide signaling to stimulate the redistribution.

4.  Extending RFC 7400

   This specification Extends "6LoWPAN-GHC: Generic Header Compression
   for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"
   [RFC7400] by defining a new capability bit for use in the 6CIO.
   [RFC7400] was already extended by [RFC8505] for use in IPv6 ND
   messages.

   The new "Registration for prefixes Supported" (F) flag indicates to
   the 6LN that the 6LR accepts IPv6 prefix registrations as specified
   in this document and will ensure that packets for the addresses that
   match this prefix will be routed to the 6LNs that registered the
   prefix, and the route to the prefix will be redistributed if the R
   flag is set to 1.





Thubert                  Expires 8 December 2025                [Page 8]

Internet-Draft             Prefix Registration                 June 2025


   Figure 1 illustrates the F flag in its position (16, counting 0 to 47
   in network order in the 48-bit array).

   - to be confirmed by IANA

   - and updated by RFC Editor if needed.


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |   Length = 1  | Experimental  |X|A|D|L|B|P|E|G|
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |F|                         Reserved                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 1: New Capability Bit in the 6CIO

   New Option Field:

   *F:*  1-bit flag, set to 1 to indicate "Registration for prefixes
      Supported"

5.  Updating RFC 6550

   [RFC6550] uses the Path Sequence in the Transit Information Option
   (TIO) to retain only the freshest unicast route and remove stale
   ones, e.g., in the case of mobility.  [RFC9010] copies the TID from
   the EARO into the Path Sequence, and the ROVR field into the
   associated RPL Target Option (RTO).  This way, it is possible to
   identify both the registering node and the order of registration in
   RPL for each individual advertisement, so the most recent path and
   lifetime values are used.

   [RFC9685] requires the use of the ROVR field as the indication of the
   origin of a Target advertisement in the RPL DAO messages, as
   specified in section 6.1 of [RFC9010].  For anycast and multicast
   advertisements (in NS or DAO messages), multiple origins may
   subscribe to the same address, in which case the multiple
   advertisements from the different or unknown origins are merged by
   the common parent; in that case, the common parent becomes the origin
   of the merged advertisements and uses its own ROVR value.  On the
   other hand, a parent that propagates an advertisement from a single
   origin uses the original ROVR in the propagated RTO, as it does for
   unicast address advertisements, so the origin is recognized across
   multiple hops.





Thubert                  Expires 8 December 2025                [Page 9]

Internet-Draft             Prefix Registration                 June 2025


   This specification Extends [RFC6550] to require that, for prefix
   routes, the Path Sequence is used between and only between
   advertisements for the same Target and from the same origin (i.e.,
   with the same ROVR value); in that case, only the freshest
   advertisement is retained.  But the freshness comparison cannot apply
   if the origin is not determined (i.e., the origin did not support
   this specification).

   [RFC6550] uses the Path Lifetime in the TIO to indicate the remaining
   time for which the advertisement is valid for unicast route
   determination, and a Path Lifetime value of 0 invalidates that route.
   [RFC9010] maps the Address Registration lifetime in the EARO and the
   Path Lifetime in the TIO so they are comparable when both forms of
   advertisements are received.

   The RPL router that merges multiple advertisements for the same
   prefix uses and advertises the longest remaining lifetime across all
   the origins of the advertisements for that prefix.  When the lifetime
   expires, the router sends a no-path DAO (i.e., the lifetime is 0)
   using the same value for ROVR value as for the previous
   advertisements, that is either itself or the single descendant that
   advertised the Target.

   Note that the Registration Lifetime, TID and ROVR fields are also
   placed in the EDAR message so the state created by EDAR is also
   comparable with that created upon an NS(EARO) or a DAO message.  For
   simplicity the text below mentions only NS(EARO) but applies also to
   EDAR.

6.  Updating RFC 8505

   This specification Extends the EARO and EDAR messages to enable the
   registration of prefixes and updates the Registration operation in
   the case of a prefix, in particular from the standpoint of the 6LR,
   e.g., to enable the Registration of overlapping prefixes.

6.1.  Leveraging the Target Address to Advertise a Prefix

   [RFC4861] expects that the NS/NA exchange is for a unicast address,
   which is indicated in the Target Address field of the ND message.
   Section 5.5 of [RFC8505] extends [RFC4861] to signal the Registered
   Address in the Target Address field.

   This specification extends the above to register a prefix.  In that
   case, the Target Address field must contain an address that is
   derived from the registered prefix, and the prefix length is
   indicated in the EARO of the NS message, overloading the field that
   is used in the NA response for the Status.



Thubert                  Expires 8 December 2025               [Page 10]

Internet-Draft             Prefix Registration                 June 2025


   If the 6LN owns one or more address that matches the registered
   prefix, then it MUST use that one of these addresses.

6.2.  New P-Field value

   [RFC9685] defines a 2-bit P-Field with values 0 through 2 and
   reserves the value 3 for future use.  This specification defines the
   semantics of P-Field value 3.

   When the P-Field is set to 3, it indicates that the Registered
   Address represents a prefix rather than a single address.  Upon
   receiving an NS(EARO) message with the P-Field set to 3, the receiver
   MUST install a route to the indicated prefix via the source address
   of the NS(EARO) message.

   This specification assigns the value 3 to the P-Field, resulting in
   the following complete set of defined values:

             +-------+--------------------------------------+
             | Value | Meaning                              |
             +-------+--------------------------------------+
             | *0*   | Registration for a Unicast Address   |
             +-------+--------------------------------------+
             | *1*   | Registration for a Multicast Address |
             +-------+--------------------------------------+
             | *2*   | Registration for an Anycast Address  |
             +-------+--------------------------------------+
             | *3*   | Registration for a Unicast prefix    |
             +-------+--------------------------------------+

                         Table 1: P-Field Values

6.3.  New EARO Prefix Length Field and F flag

   Section 4.1 of [RFC8505] defines the EARO as an extension to the ARO
   option defined in [RFC6775].

   The Status field that is used only when the EARO is placed in an NA
   message.  This specification repurposes that field to carry the
   prefix length when the EARO is placed in an NS message as illustrated
   in Figure 2.  The prefix length is expressed as 7 bits and the most
   significant bit of the field is reserved.  A 7-bit value of 0 is
   understood as a truncated 128, meaning that this registration is for
   an address as opposed to a prefix.  This approach is backward
   compatible with [RFC8505] and spans both addresses and prefixes.






Thubert                  Expires 8 December 2025               [Page 11]

Internet-Draft             Prefix Registration                 June 2025


   This specification adds a new F flag to signal that the Registered
   Prefix is topologically correct through the Registering Node.  This
   means that the Registering Node relays packets that are sourced in
   the Registered Prefix to the outside, in accordance with "Network
   Ingress Filtering" [BCP38] .  The receiver forwards packets to the
   Registering Node address when the source address of the packets
   derives from the Registered Prefix.  Note that to avoid loops, the
   receiver must be in the inside so packets sent by the sender towards
   the outside may never reach the receiver.  The notion of inside and
   outside are administratively defined, e.g., inside is a particular
   Layer-2 network such as an Ethernet fabric.

   When the F flag is not set, the Registering Node owns the prefix and
   will deliver packets to the destination if the destination address
   derives from the prefix.  Conversely, if the F flag is set, the
   Registering Node will forward traffic whose source address derives
   from the Registered Prefix into a network location (e.g., to an ISP
   Provider Edge) where this source address is topologically correct
   (e.g., derives from a prefix assigned by that ISP).  The F flag is
   encoded in the most significant bit of the EARO Status field when the
   Status field is used to transport a Prefix Length as shown in
   Figure 2.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Length    |F|Prefix Length|    Opaque     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |r|C| P | I |R|T|     TID       |     Registration Lifetime     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
    ...                            ROVR                             ...
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            Figure 2: EARO Option Format for Use in NS Messages

   New and updated Option Fields:

   *F:* (Forwarding Flag)  A 1-bit flag.  When set to 1, it indicates
      that the sender expects other routers to forward packets to the
      sender when those packets are sourced from within the registered
      prefix.

   *Prefix Length:*  A 7-bit unsigned integer.  When the P-Field is set
      to 3 and the EARO is included in a Neighbor Solicitation (NS)
      message, this field MUST contain a prefix length expressed in
      bits, with a value between 16 and 120 inclusive.  When the EARO is



Thubert                  Expires 8 December 2025               [Page 12]

Internet-Draft             Prefix Registration                 June 2025


      included in a Neighbor Advertisement (NA) message, this field MUST
      carry a Status value, regardless of the setting of the P-Field.
      In all other cases, this field is reserved; it MUST be set to zero
      by the sender and MUST be ignored by the receiver.

   *r* (reserved):  A 1-bit reserved field.  It MUST be set to zero by
      the sender and MUST be ignored by the receiver.

6.4.  New EDAR Prefix Length Field

   This specification adds the new value of 3 to the P-Field to signal
   that the Registered Address is a prefix.  When that is the case, the
   prefix is assumed to be at most 120 bits long, padded with zeros up
   to 120 bits, and the remaining 8 bits are dedicated to the prefix
   length.

   Figure 3 illustrates the EDAR message when the value of the P-Field
   is 3.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |CodePfx|CodeSfx|          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |P=3| Reserved  |     TID       |     Registration Lifetime     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
    ...                          ROVR                               ...
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                           Prefix                              +
     |                                                               |
     +                 (up to 120 bits, padded with 0s)              +
     |                                                               |
     +                                               +-+-+-+-+-+-+-+-+
     |                                               |r|Prefix Length|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 Figure 3: EDAR Message Format with P == 3

   New and updated Option Fields:

   *Reserved:*  A 6-bit field reserved for future use.  It MUST be set
      to zero by the sender and MUST be ignored by the receiver.

   *Prefix:*  A 15-byte field that carries up to 120 bits of the prefix.




Thubert                  Expires 8 December 2025               [Page 13]

Internet-Draft             Prefix Registration                 June 2025


      If the prefix isshorter than 120 bits, the remaining bits MUST be
      padded with zeros.  The receiver MUST treat the padding as zeroed
      and MUST overwrite any unused bits with zeros before using the
      prefix.

   *r* (reserved):  A 1-bit reserved field.  It MUST be set to zero by
      the sender and MUST be ignored by the receiver.

   *Prefix Length:*  A 7-bit unsigned integer indicating the length of
      the prefix in bits.  The value MUST be in the inclusive range of
      16 to 120.

6.5.  Amending the Registration Operation

   With [RFC8505]:

   *  A router that expects to reboot may send a final RA message, upon
      which nodes should register elsewhere or redo the registration to
      the same router upon reboot.  In all other cases, a node reboot is
      silent.  When the node comes back to life, existing registration
      state might be lost if it was not safely stored, e.g., in
      persistent memory.

   *  Only unicast addresses can be registered.

   *  The 6LN must register all its Unique Local Addresses (ULAs) and
      Global Unicast Addresses (GUAs) with a NS(EARO).

   *  The 6LN may set the R flag in the EARO to obtain return
      reachability services by the 6LR, e.g., through ND proxy
      operations, or by injecting the route in a route-over subnet.

   *  The 6LR maintains a registration state per Registered Address,
      including an NCE with the Link Layer Address (LLA) of the
      Registered Node (the 6LN here).

   The operation for registering prefixes is similar as for addresses
   from the perspective of the 6LN, but shows important differences on
   the router side, which maintains a separate state for each origin and
   merges them in its own advertisements.  This specification adds the
   following behavior, similar to that introduced by [RFC9685] for
   multicast addresses:

   *  The ARO Status indicating a "Registration Refresh Request" applies
      to prefixes as well.






Thubert                  Expires 8 December 2025               [Page 14]

Internet-Draft             Prefix Registration                 June 2025


      This status is used in asynchronous NA(EARO) messages to indicate
      to peer 6LNs that they are requested to reregister all addresses
      and prefixes that were previously registered to the originating
      node.  The NA message MAY be sent to a unicast or a multicast
      link-scope address and SHOULD be contained within the L2 range
      where nodes may effectively have registered/subscribed to this
      router, e.g., a radio broadcast domain to preserve energy and
      spectrum.

      A device that wishes to refresh its state, e.g., upon reboot if it
      may have lost some registration state, SHOULD send an asynchronous
      NA(EARO) with this new status value.  That asynchronous NA(ARO)
      SHOULD be sent to the all-nodes link-scope multicast address
      (ff02::1) and Target MUST be set to the link-local address that
      was exposed previously by this node to accept registrations, and
      the TID MUST be set to 0; the ROVR field MUST be set to all zeroes
      and ignored by the receiver.

      In an environment with unreliable transmissions, the multicast
      NA(EARO) message may be resent in a fast sequence, in which case
      the TID is incremented each time.  A 6LN that has recently
      processed the NA(EARO) indicating a "Registration Refresh Request"
      ignores the additional NA(EARO) also indicating a "Registration
      Refresh Request" within the duration of the fast sequence.  That
      duration depends on the environment and has to be configured.  By
      default, it is of 10 seconds.

   *  Registration for prefixes is now supported.  The value of 3 in the
      P-Field of the EARO and the EDAR message signals when the
      registration is for a prefix as opposed to an address.  DAD for
      prefixes and addresses becomes a prefix overlap match.  Whether
      overlapping addresses and prefixes may be registered is a network
      policy decision and out of scope.  The same prefix may be injected
      twice (multiple routes) as long as they use the same value of the
      ROVR.

      Overlaps may be desirable.  It may happen for instance that a
      router or a proxy (see Section 9) registers a prefix or an
      aggregation while a host using an address from that prefix or a
      prefix from that aggregation also registers its piece.

      In case of an overlapping registration, the longest prefix match
      wins, meaning that if the network policy allows for overlapping
      registrations, then the routes for the registered prefixes are
      installed towards the node that registered with the longest prefix
      match, all the way to /128.





Thubert                  Expires 8 December 2025               [Page 15]

Internet-Draft             Prefix Registration                 June 2025


   *  If the 6LR acts as a border router to external prefixes or owns
      the prefixes entirely, it SHOULD register all those prefixes on
      all interfaces from which it might be needed to relay traffic to
      that prefix.  It MUST set the P-Field in the EARO to 3 for those
      prefixes, and the set R flag to receive the traffic associated to
      the prefixes.  It MAY refrain from registering a prefix on one
      interface if that prefix is already successfully registered on
      another interface, or the router handled the EDAR / EDAC flow by
      itself, to ensure that the prefix ownership is known and validated
      by the 6LBR.  Additionally, if the router expect to receive
      traffic for that prefix on that interface, it needs to ensure that
      the prefix is advertised some other way, e.g., over a routing
      protocol such as RPL.

   *  The 6LN MAY set the R flag in the EARO to request the 6LR to
      redistribute the prefix on other links using a routing protocol.
      The 6LR MUST NOT reregister that prefix to yet another router
      unless loops are avoided some way, e.g., following a tree
      structure.

   *  The 6LR and the 6LBR are extended to accept more than one
      registration for the same prefix, since multiple 6LNs may register
      it.  The ROVR in the EARO identifies uniquely a registration
      within the namespace of the Registered Prefix.

   *  The 6LR MUST maintain a registration state per tuple (IPv6 prefix/
      length, ROVR) for all registered prefixes.  It SHOULD notify the
      6LBR with an EDAR message, unless it determined that the 6LBR is
      legacy and does not support this specification (see Section 4).
      In turn, the 6LBR MUST maintain a registration state per tuple
      (IPv6 prefix, ROVR) for all prefixes.

7.  Updating RFC 9010

   With [RFC9010]:

   *  The 6LR injects only unicast routes in RPL.

   *  Upon a registration with the R flag set to 1 in the EARO, the 6LR
      injects the address in the RPL unicast support.

   *  Upon receiving a packet directed to a unicast address for which it
      has an active registration, the 6LR delivers the packet as a
      unicast layer-2 frame to the LLA of the node that registered the
      unicast address.

   This specification adds the following behavior:




Thubert                  Expires 8 December 2025               [Page 16]

Internet-Draft             Prefix Registration                 June 2025


   *  Upon a registration with the R flag set to 1 and the P-Field set
      to 3 in the EARO, the 6LR injects the prefix in RPL using a prefix
      RTO.  The P-Field in the RTP MUST be set to 3.

   *  Upon receiving a packet directed to an address that derives from a
      prefix for which it has at least one registration, the 6LR
      delivers a copy of the packet as a unicast layer-2 frame to the
      LLA of exactly one of the nodes that registered to that prefix,
      using the longest prefix match derivation to find the best 6LN.

8.  Updating RFC 8928

   Address-Protected Neighbor Discovery for Low-Power and Lossy Networks
   [RFC8928] was defined to protect the ownership of unicast IPv6
   addresses that are registered with [RFC8505].

   With [RFC8928], it is possible for a node to autoconfigure a pair of
   public and private keys and use them to sign the registration of
   addresses that are either autoconfigured or obtained through other
   methods.

   The first hop router (the 6LR) can then validate a registration and
   perform source address validation on packets coming from the sender
   node (the 6LN).

   As multiple nodes may register the same prefix, the method specified
   in [RFC8928] cannot be used with node-local autoconfigured keypairs,
   which protect a single ownership only.

   For a prefix, as for an anycast or a multicast address, it is still
   possible to leverage [RFC8928] to enforce the right to register.  If
   [RFC8928] is used, a keypair MUST be created and associated with the
   prefix before the prefix is deployed, and a ROVR MUST be generated
   from that keypair as specified in [RFC8928].  The prefix and the ROVR
   MUST then be installed in the 6LBR at the first registration, or by
   an external mechanism such as IP Address Management (IPAM) or DHCPv6
   snooping prior to the first registration.  This way, the 6LBR can
   recognize the prefix on the future registrations and validate the
   right to register based on the ROVR.

   The keypair MUST then be provisioned in each node that needs to
   register the prefix or a prefix within, so the node can follow the
   steps in [RFC8928] to register the prefix.

   Upon receiving an NA message with the status set to 5 "Validation
   Requested", the node that registered the address or prefix performs
   the proof of ownership based on that longest prefix match.




Thubert                  Expires 8 December 2025               [Page 17]

Internet-Draft             Prefix Registration                 June 2025


9.  Extending RFC 8929

   "IPv6 Backbone Router" [RFC8929] defines a proxy operation whereby a
   6LoWPAN Border Router (6LBR) may impersonate a 6LN when performing an
   address registration.  In that case, [RFC8505] messages are used as
   is, with one change that the SLLAO in the proxied NS(EARO) messages
   indicates the Registering Node (the 6LBR) as opposed to the
   Registered Node (the 6LN).  See figure 5 of [RFC8929] for an example
   of proxy operation by the 6LBR, which generates an NS(EARO) upon
   receiving an EDAR message.

   This specification Extends that proxy operation with the updates in
   [RFC9685] and this on the formats and content of the EARO, the EDAR,
   and the EDAC messages, to support the P-Field and the signaling of
   prefixes.  The proxy MUST use the P-Field as received in the EDAR or
   NS(EARO) message to generate the proxied NS(EARO), and it MUST use
   the exact same prefix and prefix length as received in the case of a
   prefix registration.

10.  Security Considerations

   This specification extends [RFC8505], and the security section of
   that document also applies to this document.  In particular, the link
   layer SHOULD be sufficiently protected to prevent rogue access, else
   a rogue node with physical Access to the network may inject packets
   and perform an attack from within.

   Section 8 leverages [RFC8928] to prevent a rogue node to register a
   unicast address that it does not own.  The mechanism could be
   extended to anycast and multicast addresses if the values of the ROVR
   they use are known in advance, but how this is done is not in scope
   for this specification.  One way would be to authorize in advance the
   ROVR of the valid users.  A less preferred way could be to
   synchronize the ROVR and TID values across the valid registering
   nodes as a preshared key material.

   In the latter case, it could be possible to update the keys
   associated to a prefix in all the 6LNs, but the flow is not clearly
   documented and may not complete in due time for all nodes in LLN use
   cases.  It may be simpler to install an all-new address with new keys
   over a period of time, and switch the traffic to that address when
   the migration is complete.

11.  Operational Considerations







Thubert                  Expires 8 December 2025               [Page 18]

Internet-Draft             Prefix Registration                 June 2025


11.1.  Partially Upgraded Networks

   A mix of devices that support only [RFC8505], both [RFC8505] and
   [RFC9685], and all of the above plus this specification, may coexist.
   Different cases may occur:

   *  A legacy 6LN will not register prefixes and the service will be
      the same when the network is upgraded.

   *  A legacy 6LR will not set the F flag in the 6CIO and an upgraded
      6LN will not register prefixes with that router, though it may
      with other 6LRs that do support this specification.

   *  Upon an EDAR message, a legacy 6LBR may not realize that the
      address being registered comes with a whole prefix, and return
      that it is duplicate in the EDAC status.  The 6LR MUST ignore a
      duplicate status in the EDAR for prefixes.

11.2.  Application to RPL-Based Route-Over LLNs

   This specification also extends [RFC6550] and [RFC9010] in the case
   of a route-over multilink subnet based on the RPL routing protocol,
   to add multicast ingress replication in Non-Storing Mode and anycast
   support in both Storing and Non-Storing modes.  A 6LR that implements
   the RPL extensions specified therein MUST also implement [RFC9010].

   Figure 4 illustrates the classical situation of an LLN as a single
   IPv6 Subnet, with a 6LoWPAN Border Router (6LBR) that acts as Root
   for RPL operations and as Address Registrar for 6LowPAN ND.






















Thubert                  Expires 8 December 2025               [Page 19]

Internet-Draft             Prefix Registration                 June 2025


            .- -- .
         .-(        ).
        (   Internet   )
       (___.________.___)
                 |
      ---+-------+--
         |
       +--------+
       |  6LBR  |
       | (Root) |
       +--------+
       o   o  o  o
         o   o  o
    o  o  o       o  o  o
    o  o  o  LLN   o   +-------+
      o  o          o  |  6LR  | RPL Router
      o o    o   o     +-------+
      o  o    o  o          +-------+  RPL
             o              |  6LN  |  leaf
                            +-------+  L

     o : LLN node

                     Figure 4: RPL-Based Route-Over LLN

   A RPL leaf L acting as a 6LN registers its addresses and prefixes to
   a RPL router acting as a 6LR, using a layer-2 unicast NS message with
   an EARO as specified in [RFC8505] and [RFC9685].  Note that a RPL
   leaf acting as 6LN may still be a border router for another routing
   protocol, an access router for an IP link, or a virtual Router
   serving virtual machines or applications within the same physical
   node.  Note also that a RPL-aware Leaf would preferably leverage RPL
   directly to inject routes, to fully leverage the routing protocol.
   The registration state is periodically renewed by the Registering
   Node (the 6LN), before the lifetime indicated in the EARO expires (at
   the 6LR).  As for unicast IPv6 addresses, the 6LR uses an Extended
   Duplicate Address Request/Confirmation (EDAR/EDAC) exchange with the
   6LBR to notify the 6LBR of the presence of the listeners.  With this
   specification, a router that owns a prefix or provides reachability
   to an external prefix but is not a RPL router can also register those
   prefixes with the R flag set, to enable reachability to the Prefix
   within the RPL domain.









Thubert                  Expires 8 December 2025               [Page 20]

Internet-Draft             Prefix Registration                 June 2025


11.3.  Application to a Shared Link

   A shared link is a situation where more than one prefix is deployed
   over a L2 link (say a switched Ethernet fabric, or a Wi-Fi Extended
   Service Set (ESS) federating multiple Access Points (APs)), and not
   necessarily all nodes are aware of all prefixes.  Figure 5 depicts
   such a situation, with 2 routers 6LR1 and 6LR2 that own respective
   prefixes P1:: and P2::, and expose those in their RA messages over
   the same link.  Note that the shared link maybe operated with any
   combination of NDP and SND as discussed in section 7 of
   [I-D.ietf-6man-ipv6-over-wireless].

            .- -- .
         .-(        ).
        (   Internet   )
       (___.________.___)
             |
        +----+--+          +-------+
        | P1::a |          | P2::b |
        | 6LR1  |          | 6LR2  |
        +---+---+          +---+---+
            |                  |
     ----+--+------+---------+-+-------+---------+----
         |         |         |         |         |
      +--+--+   +--+--+   +--+--+   +--+--+   +--+--+
      |P1::c|   |P2::d|   |P2::e|   |P1::f|   |P1::g|
      +-----+   +-----+   +-----+   +-----+   +-----+


                           Figure 5: Shared Link

   Say that 6LR1 is the router providing access to the outside, and 6LR2
   is aware of 6LR1 as its default gateway.  With this specification,
   6LR2 registers P2:: to 6LR1 and 6LR1 installs a route to P2:: via
   6LR2.  This way, addresses that derive from P2:: can still be reached
   via 6LR1 and then 6LR2.  6LR2 may then leverage ICMP Redirect
   messages [RFC4861] to shorten the path between 6LR1 and the nodes
   that own those addresses.

   If P2 was delegated by 6LR1, e.g., using the "Dynamic Host
   Configuration Protocol for IPv6" [RFC8415] (DHCPv6), then the
   expectation is that 6LR1 aggregates P1:: and P2:: in its
   advertisements to the outside, and there is no need to set the R
   flag.  But unless 6LR2 knows about such a situation, e.g., through
   configuration, 6LR2 SHOULD set the R flag requesting 6LR1 to
   advertise P2:: so as to obtain reachability.





Thubert                  Expires 8 December 2025               [Page 21]

Internet-Draft             Prefix Registration                 June 2025


11.4.  Application to a Hub Link with Stub Spokes

   A hub link is a situation where stub links are deployed around a
   backbone and interconnected by routers.  Figure 6 depicts such a
   situation, with one router 6LR1 serving the hub link and at least one
   router like 6LR2 and 6LR3 providing connectivity from the stub links
   to the hub link.  In this example, say that there is one prefix on
   each link, P1:: on the hub link and P2:: and P3:: on the stub links.

      +-----+   +-----+   +-----+       +-----+
      |P2::s|   |P2::d|   |P2::e|       |P2::f|
      +--+--+   +--+--+   +--+--+       +--+--+
         |         |         |             |
     ----+----+----+---------+--STUB-LINK--+-----
              |
          +---+---+              +-------+
          | P2::r |              |       |        .- --..
          | 6LR2  |              | 6LR1  +---- .-(       ).
          | P1::b |              | P1::a |   (   Internet  )
          +---+---+              +---+---+  (___._______.___)
              |                      |              |
     -------+-+---------+--HUB-LINK--+-----+--      |
            |           |                  |        |
        +---+---+    +--+--+           +---+---+    |
        | P1::c |    |P1::n|           | P1::q |    |
        | 6LR3  |    +-----+           | 6LR4  +----+
        | P3::m |                      | P3::a |
        +---+---+                      +---+---+
            |                              |
     ----+--+------+---------+--STUB-LINK--+-+-----
         |         |         |               |
      +--+--+   +--+--+   +--+--+         +--+--+
      |P3::h|   |P3::i|   |P3::j|         |P3::k|
      +-----+   +-----+   +-----+         +-----+


                          Figure 6: Hub and Stubs

   As before, say that 6LR1 is the router providing access to the
   outside, and 6LR2 is aware of 6LR1 as its default gateway.  With this
   specification, 6LR2 registers P2:: to 6LR1 and 6LR1 installs a route
   to P2:: via 6LR2.  This way, nodes on the stub link behind 6LR2 that
   derive their addresses from P2:: can still be reached via 6LR1 and
   then 6LR2.  The same goes for 6LR3 and any other routers serving stub
   links.






Thubert                  Expires 8 December 2025               [Page 22]

Internet-Draft             Prefix Registration                 June 2025


   If P2 was delegated by 6LR1, then the expectation is that 6LR1
   aggregates P1:: and P2:: in its advertisements to the outside, and
   there is no need to set the R flag.  But unless 6LR2 knows about such
   a situation, e.g., through configuration, 6LR2 SHOULD set the R flag
   requesting 6LR1 to advertise P2:: so as to obtain reachability.

   In this example, routers 6LR3 and 6LR4 both connect to the same stub
   link where subnet P3 is installed.  They may both register P3 to
   6LR1, and 6LR1 will apply its own load balancing logic to use either
   of the routers.

12.  IANA Considerations

   Note to RFC Editor, to be removed: please replace "This RFC"
   throughout this document by the RFC number for this specification
   once it is allocated.

   IANA is requested to make changes under the "Internet Control Message
   Protocol version 6 (ICMPv6) Parameters" [IANA.ICMP] and the "Routing
   Protocol for Low Power and Lossy Networks (RPL)" [IANA.RPL] registry
   groupings, as follows:

12.1.  Updated P-Field Registry

   This specification updates the P-Field introduced in [RFC9685] to
   assign the value of 3, which is the only remaining unassigned value
   for the 2-bit field.  To that effect, IANA is requested to update the
   "P-Field values" registry under the heading "Internet Control Message
   Protocol version 6 (ICMPv6) Parameters" as indicated in Table 2:

             +-------+---------------------------+-----------+
             | Value | Meaning                   | Reference |
             +-------+---------------------------+-----------+
             | *3*   | Registration for a prefix | This RFC  |
             +-------+---------------------------+-----------+

                         Table 2: New P-Field value

12.2.  New 6LoWPAN Capability Bit

   IANA is requested to make an addition to the "6LoWPAN Capability
   Bits" [IANA.ICMP.6CIO] registry under the heading "Internet Control
   Message Protocol version 6 (ICMPv6) Parameters" as indicated in
   Table 3:

   IANA is also requested to fix the description of bit 9 (the "A" flag
   defined in [RFC8928]).  It is not called "1" but "A".




Thubert                  Expires 8 December 2025               [Page 23]

Internet-Draft             Prefix Registration                 June 2025


       +------------------+---------------------------+-----------+
       | Bit              | Description               | Reference |
       +------------------+---------------------------+-----------+
       | *9*              | AP-ND Enabled (A bit)     | [RFC8928] |
       +------------------+---------------------------+-----------+
       | *16 (suggested)* | Registration for prefixes | This RFC  |
       |                  | Supported (F bit)         |           |
       +------------------+---------------------------+-----------+

                   Table 3: New 6LoWPAN Capability Bit

13.  Acknowledgments

   Many thanks to Dave Thaler and Dan Romascanu for their early reviews,
   Adnan Rashid for all his contributions, and Eric Vyncke for his in-
   depth AD review.  Many thanks as well to the reviewers of the IETF
   last call and IESG rounds, Shuping Peng, Mohamed Boucadair, Paul
   Wouters, Ketan Talaulikar, Gunter Van de Velde, Mike Bishop, Roman
   Danyliw, ...

14.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", RFC 4861,
              DOI 10.17487/RFC4861, September 2007,
              <https://www.rfc-editor.org/info/rfc4861>.

   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", RFC 4862,
              DOI 10.17487/RFC4862, September 2007,
              <https://www.rfc-editor.org/info/rfc4862>.

   [RFC6550]  Winter, T., Ed., Thubert, P., Ed., Brandt, A., Hui, J.,
              Kelsey, R., Levis, P., Pister, K., Struik, R., Vasseur,
              JP., and R. Alexander, "RPL: IPv6 Routing Protocol for
              Low-Power and Lossy Networks", RFC 6550,
              DOI 10.17487/RFC6550, March 2012,
              <https://www.rfc-editor.org/info/rfc6550>.








Thubert                  Expires 8 December 2025               [Page 24]

Internet-Draft             Prefix Registration                 June 2025


   [RFC6775]  Shelby, Z., Ed., Chakrabarti, S., Nordmark, E., and C.
              Bormann, "Neighbor Discovery Optimization for IPv6 over
              Low-Power Wireless Personal Area Networks (6LoWPANs)",
              RFC 6775, DOI 10.17487/RFC6775, November 2012,
              <https://www.rfc-editor.org/info/rfc6775>.

   [RFC7400]  Bormann, C., "6LoWPAN-GHC: Generic Header Compression for
              IPv6 over Low-Power Wireless Personal Area Networks
              (6LoWPANs)", RFC 7400, DOI 10.17487/RFC7400, November
              2014, <https://www.rfc-editor.org/info/rfc7400>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", STD 86, RFC 8200,
              DOI 10.17487/RFC8200, July 2017,
              <https://www.rfc-editor.org/info/rfc8200>.

   [RFC8505]  Thubert, P., Ed., Nordmark, E., Chakrabarti, S., and C.
              Perkins, "Registration Extensions for IPv6 over Low-Power
              Wireless Personal Area Network (6LoWPAN) Neighbor
              Discovery", RFC 8505, DOI 10.17487/RFC8505, November 2018,
              <https://www.rfc-editor.org/info/rfc8505>.

   [RFC8928]  Thubert, P., Ed., Sarikaya, B., Sethi, M., and R. Struik,
              "Address-Protected Neighbor Discovery for Low-Power and
              Lossy Networks", RFC 8928, DOI 10.17487/RFC8928, November
              2020, <https://www.rfc-editor.org/info/rfc8928>.

   [RFC8929]  Thubert, P., Ed., Perkins, C.E., and E. Levy-Abegnoli,
              "IPv6 Backbone Router", RFC 8929, DOI 10.17487/RFC8929,
              November 2020, <https://www.rfc-editor.org/info/rfc8929>.

   [RFC9010]  Thubert, P., Ed. and M. Richardson, "Routing for RPL
              (Routing Protocol for Low-Power and Lossy Networks)
              Leaves", RFC 9010, DOI 10.17487/RFC9010, April 2021,
              <https://www.rfc-editor.org/info/rfc9010>.

   [RFC9685]  Thubert, P., Ed., "Listener Subscription for IPv6 Neighbor
              Discovery Multicast and Anycast Addresses", RFC 9685,
              DOI 10.17487/RFC9685, November 2024,
              <https://www.rfc-editor.org/info/rfc9685>.







Thubert                  Expires 8 December 2025               [Page 25]

Internet-Draft             Prefix Registration                 June 2025


   [IANA.ICMP]
              IANA, "IANA Registry for ICMPv6", IANA,
              https://www.iana.org/assignments/icmpv6-parameters/
              icmpv6-parameters.xhtml.

   [IANA.ICMP.6CIO]
              IANA, "IANA Registry for the 6LoWPAN Capability Bits",
              IANA, https://www.iana.org/assignments/icmpv6-parameters/
              icmpv6-parameters.xhtml#sixlowpan-capability-bits.

   [IANA.RPL] IANA, "IANA Registry for the RPL",
              IANA, https://www.iana.org/assignments/rpl/rpl.xhtml.

15.  Informative References

   [BCP38]    Ferguson, P. and D. Senie, "Network Ingress Filtering:
              Defeating Denial of Service Attacks which employ IP Source
              Address Spoofing", BCP 38, RFC 2827, DOI 10.17487/RFC2827,
              May 2000, <https://www.rfc-editor.org/info/rfc2827>.

   [RFC4191]  Draves, R. and D. Thaler, "Default Router Preferences and
              More-Specific Routes", RFC 4191, DOI 10.17487/RFC4191,
              November 2005, <https://www.rfc-editor.org/info/rfc4191>.

   [RFC4919]  Kushalnagar, N., Montenegro, G., and C. Schumacher, "IPv6
              over Low-Power Wireless Personal Area Networks (6LoWPANs):
              Overview, Assumptions, Problem Statement, and Goals",
              RFC 4919, DOI 10.17487/RFC4919, August 2007,
              <https://www.rfc-editor.org/info/rfc4919>.

   [RFC6282]  Hui, J., Ed. and P. Thubert, "Compression Format for IPv6
              Datagrams over IEEE 802.15.4-Based Networks", RFC 6282,
              DOI 10.17487/RFC6282, September 2011,
              <https://www.rfc-editor.org/info/rfc6282>.

   [RFC8415]  Mrugalski, T., Siodelski, M., Volz, B., Yourtchenko, A.,
              Richardson, M., Jiang, S., Lemon, T., and T. Winters,
              "Dynamic Host Configuration Protocol for IPv6 (DHCPv6)",
              RFC 8415, DOI 10.17487/RFC8415, November 2018,
              <https://www.rfc-editor.org/info/rfc8415>.

   [RFC9030]  Thubert, P., Ed., "An Architecture for IPv6 over the Time-
              Slotted Channel Hopping Mode of IEEE 802.15.4 (6TiSCH)",
              RFC 9030, DOI 10.17487/RFC9030, May 2021,
              <https://www.rfc-editor.org/info/rfc9030>.






Thubert                  Expires 8 December 2025               [Page 26]

Internet-Draft             Prefix Registration                 June 2025


   [I-D.ietf-6man-ipv6-over-wireless]
              Thubert, P. and M. Richardson, "Architecture and Framework
              for IPv6 over Non-Broadcast Access", Work in Progress,
              Internet-Draft, draft-ietf-6man-ipv6-over-wireless-08, 19
              May 2025, <https://datatracker.ietf.org/doc/html/draft-
              ietf-6man-ipv6-over-wireless-08>.

   [IEEE802154]
              IEEE standard for Information Technology, "IEEE Std
              802.15.4, Part. 15.4: Wireless Medium Access Control (MAC)
              and Physical Layer (PHY) Specifications for Low-Rate
              Wireless Personal Area Networks".

   [IEEE80211]
              IEEE standard for Information Technology, "IEEE Standard
              802.11 - IEEE Standard for Information Technology -
              Telecommunications and information exchange between
              systems Local and metropolitan area networks - Specific
              requirements - Part 11: Wireless LAN Medium Access Control
              (MAC) and Physical Layer (PHY) Specifications.",
              <https://ieeexplore.ieee.org/document/9363693>.

   [WI-SUN]   "Wi-SUN Alliance", <https://wi-sun.org/>.

   [IEEE802151]
              IEEE standard for Information Technology, "IEEE Standard
              for Information Technology - Telecommunications and
              Information Exchange Between Systems - Local and
              Metropolitan Area Networks - Specific Requirements. - Part
              15.1: Wireless Medium Access Control (MAC) and Physical
              Layer (PHY) Specifications for Wireless Personal Area
              Networks (WPANs)".

Author's Address

   Pascal Thubert (editor)
   06330 Roquefort-les-Pins
   France
   Email: pascal.thubert@gmail.com












Thubert                  Expires 8 December 2025               [Page 27]
